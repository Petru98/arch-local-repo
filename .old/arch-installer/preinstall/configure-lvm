configure_lvm() {
    if bool $LVM ; then
        print_title "LVM - https://wiki.archlinux.org/index.php/LVM"
        print_warning "The last partition will take 100% of the free space left"
        if bool $LUKS ; then
            pvcreate /dev/mapper/crypt
            vgcreate lvm /dev/mapper/crypt
        else
            log ""
            local block_list=($(lsblk | grep 'part' | awk '{print "/dev/" substr($1,3)}'))
            PS3="Select partition: "
            LVM=$False
            select INPUT in "${block_list[@]}"; do
                if array_contains_element "$INPUT" "${block_list[@]}"; then
                    pvcreate $INPUT
                    vgcreate lvm $INPUT
                    LVM=$True
                    break
                else
                    invalid_option
                fi
            done
        fi

        local partitions_count
        local partition_name
        local i
        prompt "Enter the number of partitions to create: " partitions_count
        for i in $(seq 1 $partitions_count) ; do
            prompt "Enter the name of the partition number $i (e.g. home): " partition_name
            if [[ $i -eq $partitions_count ]]; then
                lvcreate -l 100%FREE lvm -n "$partition_name"
            else
                prompt "Enter the size of the partition number $i (e.g. 25G, 200M): " partition_size
                lvcreate -L $partition_size lvm -n "$partition_name"
            fi
        done
    fi
}

configure_lvm
